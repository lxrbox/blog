# 复制链接功能 - 最终版本

## 功能说明

为博客添加了浮动的"复制链接"按钮，与"回到顶部"按钮放在一起，样式保持一致。

## 功能特点

✅ **浮动按钮** - 固定在页面右下角
✅ **自动显示** - 滚动超过 100px 后显示
✅ **样式一致** - 与"回到顶部"按钮样式完全一致
✅ **位置合理** - 在"回到顶部"按钮上方
✅ **一键复制** - 点击即可复制当前文章链接
✅ **视觉反馈** - 复制成功后按钮变色并显示 ✓
✅ **自动恢复** - 2秒后自动恢复原状
✅ **深色模式** - 完美支持深色模式
✅ **响应式** - 移动端自动适配

## 按钮位置

```
页面右下角：

┌─────────────┐
│  🔗 复制链接  │  ← 在上方
├─────────────┤
│  ↑ 回到顶部  │  ← 在下方
└─────────────┘
```

## 样式特点

- **圆角矩形** - 0.5rem 圆角
- **尺寸** - 2.5rem × 2.5rem（桌面端）
- **边框** - 1px 实线边框
- **背景** - 跟随主题背景色
- **悬停效果** - 边框变为主题色
- **复制成功** - 背景变为主题色，图标变白色

## 技术实现

### 组件位置
- `src/.vuepress/components/CopyLink.vue` - 复制链接组件
- `src/.vuepress/client.ts` - 全局注册

### 自动加载
组件通过 `rootComponents` 自动加载到所有页面，无需手动添加。

### 显示逻辑
```javascript
// 滚动超过 100px 后显示（与回到顶部按钮一致）
show.value = window.scrollY > 100;
```

## 使用方法

### 用户使用
1. 访问任意文章页面
2. 向下滚动超过 100px
3. 右下角会出现两个按钮
4. 点击上方的 🔗 按钮
5. 链接已复制到剪贴板

### 开发者使用
无需任何配置，组件会自动加载到所有页面。

## 自定义配置

### 调整显示阈值
编辑 `src/.vuepress/components/CopyLink.vue`：

```javascript
const handleScroll = () => {
  show.value = window.scrollY > 100; // 修改这个值
};
```

### 调整按钮位置
编辑样式部分：

```css
.vp-back-to-top-button {
  right: 1rem;      /* 距离右边的距离 */
  bottom: 4.5rem;   /* 距离底部的距离 */
}
```

### 调整按钮大小
```css
.vp-back-to-top-button {
  width: 2.5rem;    /* 宽度 */
  height: 2.5rem;   /* 高度 */
}
```

### 修改图标
```vue
<span class="icon" v-if="!isCopied">🔗</span>  <!-- 默认图标 -->
<span class="icon success" v-else>✓</span>     <!-- 成功图标 -->
```

## 浏览器兼容性

- ✅ Chrome/Edge 63+
- ✅ Firefox 53+
- ✅ Safari 13.1+
- ✅ 移动端浏览器

对于不支持 Clipboard API 的旧浏览器，会自动使用 `document.execCommand('copy')` 降级方案。

## 响应式设计

### 桌面端（> 719px）
- 按钮大小：2.5rem × 2.5rem
- 右边距：1rem
- 底部距离：4.5rem

### 移动端（≤ 719px）
- 按钮大小：2.25rem × 2.25rem
- 右边距：0.75rem
- 底部距离：4rem

## 与主题集成

### CSS 变量使用
```css
--bg-color           /* 背景色 */
--bg-color-secondary /* 悬停背景色 */
--border-color       /* 边框颜色 */
--theme-color        /* 主题色（复制成功时） */
--text-color         /* 文字颜色 */
```

### 动画效果
使用与回到顶部按钮相同的 `back-to-top` 过渡动画：
- 淡入淡出
- 向上滑动
- 持续时间：0.3s

## 测试清单

- [x] 桌面端显示正常
- [x] 移动端显示正常
- [x] 深色模式正常
- [x] 浅色模式正常
- [x] 复制功能正常
- [x] 视觉反馈正常
- [x] 与回到顶部按钮样式一致
- [x] 位置合理不遮挡内容
- [x] 滚动显示/隐藏正常

## 常见问题

### Q: 为什么按钮不显示？
A: 需要向下滚动超过 100px 才会显示。

### Q: 如何调整按钮间距？
A: 修改 `bottom` 值，增大数值会让按钮向上移动。

### Q: 可以改成圆形按钮吗？
A: 可以，修改 `border-radius: 50%` 即可。

### Q: 如何禁用某个页面的复制按钮？
A: 目前是全局显示，如需禁用需要在组件中添加页面判断逻辑。

### Q: 复制失败怎么办？
A: 检查浏览器是否允许剪贴板权限，或者使用 HTTPS 协议。

## 性能影响

- **加载时间** - 几乎无影响（< 2KB）
- **运行时性能** - 仅监听滚动事件，性能开销极小
- **内存占用** - 可忽略不计

## 文件清单

### 核心文件
- `src/.vuepress/components/CopyLink.vue` - 组件实现
- `src/.vuepress/client.ts` - 全局注册

### 工具脚本
- `scripts/remove-copylink-tags.cjs` - 移除旧的内联标签

### 文档
- `docs/copy-link-final.md` - 本文档
- `docs/copy-link-guide.md` - 使用指南

## 更新日志

### v2.0 - 浮动按钮版本
- ✅ 改为浮动按钮
- ✅ 与回到顶部按钮样式一致
- ✅ 自动显示/隐藏
- ✅ 全局自动加载

### v1.0 - 内联按钮版本
- ✅ 基础复制功能
- ✅ 内联在文章末尾
- ❌ 需要手动添加到每篇文章

## 总结

现在的复制链接功能：
1. **样式统一** - 与回到顶部按钮完全一致
2. **位置合理** - 固定在右下角，不遮挡内容
3. **自动加载** - 无需手动配置
4. **用户友好** - 一键复制，视觉反馈清晰
5. **响应式** - 完美适配各种设备

完美集成到博客中，提升用户体验！
