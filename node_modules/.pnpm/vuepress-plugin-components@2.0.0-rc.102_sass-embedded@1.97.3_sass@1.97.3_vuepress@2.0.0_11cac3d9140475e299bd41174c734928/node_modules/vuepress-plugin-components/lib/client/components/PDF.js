import{isDef as S,isiPad as h,isMobile as F,isSafari as y,isLinkHttp as L,ensureEndingSlash as T,entries as D,useLocaleConfig as P}from"@vuepress/helper/client";import{useScrollLock as $}from"@vueuse/core";import{defineComponent as C,shallowRef as v,ref as E,h as f,watch as _,onMounted as j,onUnmounted as R}from"vue";import{CancelFullScreenIcon as U,EnterFullScreenIcon as z}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as I}from"vuepress/client";import{u as M}from"../useSize-DACCJVjo.js";import{g as N}from"../getLink-DBmDl_2w.js";const m=e=>{console.error(`[PDF]: ${e}`)},k=e=>{for(;e.firstChild;)e.firstChild.remove()},A=e=>e instanceof HTMLElement?e:e==="string"?document.querySelector(e):document.body,H=e=>{let t=D(e).map(([n,o])=>n==="noToolbar"?`toolbar=${o?"0":"1"}`:`${encodeURIComponent(n)}=${encodeURIComponent(o)}`).join("&");return t&&(t=`#${t.slice(0,-1)}`),t},w=(e,{embedType:t,url:n,options:o={},title:s=/\/([^/]+).pdf/.exec(n)?.[1]??"PDF Viewer"})=>{k(e);const p=`${t==="pdfjs"?`${T(I(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(n)}`:n}${H(o)}`,l=t==="pdfjs"||t==="iframe"?"iframe":"embed",r=document.createElement(l);return r.className="pdf-viewer",r.type="application/pdf",r.title=s,r.src=p,r instanceof HTMLIFrameElement&&(r.allow="fullscreen"),e.classList.add("pdf-viewer-container"),e.append(r),e.querySelector(l)},b="pdfjs url is not defined",B=(e,{url:t,title:n,hint:o=b,options:s={},pdfjs:p})=>{if(!S(window)||!window.navigator?.userAgent)return null;const{navigator:l}=window,{userAgent:r}=l,a=h()||F(),i=!a&&y(),c=!a&&/firefox/iu.test(r)&&r.split("rv:").length>1?parseInt(r.split("rv:")[1].split(".")[0],10)>18:!1,g=l.pdfViewerEnabled||c,u=A(e);if(!u)return m("Target element cannot be determined"),null;const d=L(t)?t:__VUEPRESS_DEV__?null:`${window.origin}${t}`;return p?d?PDFJS_URL?w(u,{embedType:"pdfjs",url:d,options:s,title:n}):(u.innerHTML=o.replaceAll(String.raw`\[url\]`,d),m(b),null):(m("PDF link is not accessible via internet."),null):g||!a?w(u,{embedType:i?"iframe":"embed",url:t,options:s,title:n}):PDFJS_URL&&d?w(u,{embedType:"pdfjs",url:d,options:s,title:n}):(u.innerHTML=o.replaceAll(String.raw`\[url\]`,t),m("This browser does not support embedded PDFs"),null)};var V=C({name:"PDF",props:{url:{type:String,required:!0},title:String,width:{type:[String,Number],default:"100%"},height:[String,Number],ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:[String,Number],viewer:Boolean},setup(e){const{el:t,width:n,height:o,resize:s}=M(e),p=P(PDF_LOCALES),l=v(),r=v(),a=$(l),i=E(!1);return _(i,c=>{a.value=c}),j(()=>{l.value=document.body,B(r.value,{url:N(e.url),title:e.title,hint:p.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom&&e.zoom.toString()!=="100"?{zoom:e.zoom}:{}},pdfjs:e.viewer}),s()}),R(()=>{a.value=!1}),()=>f("div",{class:["pdf-viewer-wrapper",{fullscreen:i.value}],ref:t,style:i.value?{}:{width:n.value,height:o.value}},[f("div",{ref:r}),e.noFullscreen?null:f("button",{class:"pdf-fullscreen-button",onClick:()=>{i.value=!i.value}},f(i.value?U:z,{class:"pdf-fullscreen-icon"}))])}});export{V as default};
//# sourceMappingURL=PDF.js.map
